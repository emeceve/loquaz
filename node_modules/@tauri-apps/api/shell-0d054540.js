import{c as t,_ as n,a as e}from"./tslib.es6-9bc0804d.js";import{i}from"./tauri-7cafdaf8.js";import{t as r}from"./tauri-fa8f44bd.js";function o(t,o,s,u){return void 0===s&&(s=[]),n(this,void 0,void 0,(function(){return e(this,(function(n){return"object"==typeof s&&Object.freeze(s),[2,i({__tauriModule:"Shell",message:{cmd:"execute",program:o,args:s,options:u,onEventFn:r(t)}})]}))}))}var s=function(){function t(){this.eventListeners=Object.create(null)}return t.prototype.addEventListener=function(t,n){t in this.eventListeners?this.eventListeners[t].push(n):this.eventListeners[t]=[n]},t.prototype._emit=function(t,n){if(t in this.eventListeners)for(var e=0,i=this.eventListeners[t];e<i.length;e++){(0,i[e])(n)}},t.prototype.on=function(t,n){return this.addEventListener(t,n),this},t}(),u=function(){function t(t){this.pid=t}return t.prototype.write=function(t){return n(this,void 0,void 0,(function(){return e(this,(function(n){return[2,i({__tauriModule:"Shell",message:{cmd:"stdinWrite",pid:this.pid,buffer:"string"==typeof t?t:Array.from(t)}})]}))}))},t.prototype.kill=function(){return n(this,void 0,void 0,(function(){return e(this,(function(t){return[2,i({__tauriModule:"Shell",message:{cmd:"killChild",pid:this.pid}})]}))}))},t}(),a=function(i){function r(t,n,e){void 0===n&&(n=[]);var r=i.call(this)||this;return r.stdout=new s,r.stderr=new s,r.program=t,r.args="string"==typeof n?[n]:n,r.options=null!=e?e:{},r}return t(r,i),r.sidecar=function(t,n,e){void 0===n&&(n=[]);var i=new r(t,n,e);return i.options.sidecar=!0,i},r.prototype.spawn=function(){return n(this,void 0,void 0,(function(){var t=this;return e(this,(function(n){return[2,o((function(n){switch(n.event){case"Error":t._emit("error",n.payload);break;case"Terminated":t._emit("close",n.payload);break;case"Stdout":t.stdout._emit("data",n.payload);break;case"Stderr":t.stderr._emit("data",n.payload)}}),this.program,this.args,this.options).then((function(t){return new u(t)}))]}))}))},r.prototype.execute=function(){return n(this,void 0,void 0,(function(){var t=this;return e(this,(function(n){return[2,new Promise((function(n,e){t.on("error",e);var i=[],r=[];t.stdout.on("data",(function(t){i.push(t)})),t.stderr.on("data",(function(t){r.push(t)})),t.on("close",(function(t){n({code:t.code,signal:t.signal,stdout:i.join("\n"),stderr:r.join("\n")})})),t.spawn().catch(e)}))]}))}))},r}(s);function c(t,r){return n(this,void 0,void 0,(function(){return e(this,(function(n){return[2,i({__tauriModule:"Shell",message:{cmd:"open",path:t,with:r}})]}))}))}var d=Object.freeze({__proto__:null,Command:a,Child:u,EventEmitter:s,open:c});export{a as C,s as E,u as a,c as o,d as s};
